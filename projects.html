<!-- projects.html (directory v5 - lighter, swapped panes) -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Projects — Dominic Vicchiollo</title>
  <meta name="description" content="Projects and case studies by Dominic Vicchiollo." />
  <link rel="canonical" href="./projects.html" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Space+Grotesk:wght@600;700&display=swap" rel="stylesheet" />
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml" />
  <!-- highlight.js for SQL display -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js"></script>

  <style>
/* ======= Provided site-wide CSS (light modern palette & header) ======= */
:root {
  --bg: #0b1020;
  --surface: #0f1428;
  --card: #121a31;
  --border: #1c2442;
  --text: #e6e9ef;
  --muted: #a7b0c0;
  --primary: #22d3ee;
  --primary-2: #818cf8;
  --radius: 16px;
  --shadow: 0 12px 40px rgba(0,0,0,0.28);
  --content-max: 1680px;
  --content-wide: 1920px;
  --gutter: clamp(1rem, 2.2vw, 3.5rem);
  --section-vertical: clamp(2rem, 5vw, 5rem);
  --content-indent: 0;
  --prose-indent: 0;
  --header-h: 64px;
  --header-bg: rgba(200,205,215,0.28);
}
@media (prefers-color-scheme: light) {
  :root {
    --bg: #f7f9fc;
    --surface: #ffffff;
    --card: #ffffff;
    --border: #e5e8ef;
    --text: #0a0e1a;
    --muted: #5c667a;
    --primary: #2563eb;
    --primary-2: #22d3ee;
    --shadow: 0 10px 30px rgba(0,0,0,0.08);
    --header-bg: rgba(255,255,255,0.75);
  }
}
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji", "Segoe UI Symbol";
  color: var(--text);
  background:
    radial-gradient(1200px 600px at 20% -10%, rgba(34,211,238,0.12), transparent 60%),
    radial-gradient(800px 600px at 80% 0%, rgba(129,140,248,0.14), transparent 60%),
    var(--bg);
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}
.container,
.container-wide { width:100%; max-width:none; margin:0; padding-inline:var(--gutter); }
.hero-bleed { padding-inline: var(--gutter); }
.prose-max { max-width: 960px; }
.section { padding-block: var(--section-vertical); }
.section.alt { background: var(--surface); }
.section-title {
  font-family: "Space Grotesk", Inter, system-ui, sans-serif;
  font-weight: 700; font-size: clamp(1.6rem, 3vw, 2rem); margin: 0 0 1rem;
}
.lead { color: var(--muted); margin-bottom: 1.25rem; }
/* header + nav */
.site-header { position: sticky; top: 0; z-index:50; background: var(--header-bg); backdrop-filter: blur(10px); border-bottom: 1px solid var(--border); }
.header-inner { display:flex; align-items:center; justify-content:space-between; height:var(--header-h); padding-inline:var(--gutter); }
.brand { display:inline-flex; align-items:center; gap:.5rem; text-decoration:none; }
.brand-mark { display:inline-grid; place-items:center; inline-size:36px; block-size:36px; border-radius:10px;
  background: linear-gradient(135deg, var(--primary), var(--primary-2)); color:#000; font-weight:700; text-transform:uppercase; letter-spacing:.5px; }
.brand-text { color:var(--text); font-weight:700; letter-spacing:.3px; }
.site-nav { display:flex; gap:.25rem; align-items:center; }
.nav-link { color:var(--muted); text-decoration:none; padding:.55rem .8rem; border-radius:10px; }
.nav-link:hover, .nav-link.is-active { color:var(--text); background: rgba(0,0,0,0.06); }
.nav-toggle { display:none; border:1px solid var(--border); background:transparent; color:var(--text); padding:.5rem; border-radius:10px; }
.nav-toggle .bar { display:block; inline-size:22px; block-size:2px; background:var(--text); margin:4px 0; }
/* compact hero */
.hero { padding-block: 4px 6px; min-height:0; margin:0; }
.hero::before, .hero::after { content:none; display:none; }
.hero-inner { text-align:left; margin-inline:auto; max-width: var(--content-wide); }
/* buttons */
.btn { display:inline-block; border:1px solid var(--border); background:var(--surface); color:var(--text);
  padding:.72rem 1rem; border-radius:14px; text-decoration:none; font-weight:600; transition: transform .15s ease; }
.btn:hover { transform: translateY(-1px); }
.btn.primary { background: linear-gradient(135deg, var(--primary), var(--primary-2)); border:none; color:#05101c; }
.btn.ghost { background: transparent; }
.btn.small { padding:.5rem .7rem; font-size:.9rem; }
/* footer */
.site-footer { border-top: 1px solid var(--border); background: rgba(10,14,26,0.08); }
.footer-inner { display:flex; align-items:center; justify-content:space-between; padding-block:1rem; }
.social { display:inline-flex; gap:.75rem; }
.social a { color:var(--muted); text-decoration:none; }
.social a:hover { color:var(--text); }
/* responsive header behavior */
@media (max-width: 680px) {
  .header-inner { height:auto; padding-block:.5rem; }
  .site-nav { position:absolute; right:1rem; top:var(--header-h); background:var(--surface);
    border:1px solid var(--border); border-radius:12px; padding:.5rem; display:none; flex-direction:column; min-width:180px; box-shadow:var(--shadow); }
  .site-nav.open { display:flex; }
  .nav-toggle { display:inline-block; }
}

/* ======= App-specific styles (directory nav + two-pane workspace) ======= */
.app { padding-block: calc(var(--section-vertical) - 2rem); }
.app-layout { display:grid; grid-template-columns: 340px 1fr; gap:22px; align-items:start; }
@media (max-width: 1100px){ .app-layout{ grid-template-columns: 1fr; } }
/* left directory */
.directory { position:sticky; top: calc(var(--header-h) + 12px); align-self:start; max-height: calc(100vh - 80px); }
.dir-card{ background:var(--card); border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--shadow); display:flex; flex-direction:column; overflow:hidden; height:100%; }
.dir-head{ padding:12px 14px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; }
.dir-title{ font-weight:700; letter-spacing:.02em; }
.dir-body{ overflow:auto; }
.tree{ padding:6px; }
.tree details{ border:1px solid var(--border); border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0)); margin:6px 6px 10px; }
.tree summary{ list-style:none; cursor:pointer; padding:10px 12px; display:flex; align-items:center; justify-content:space-between; gap:10px; }
.tree summary::-webkit-details-marker{ display:none; }
.caret{ width:18px; height:18px; display:inline-grid; place-items:center; border:1px solid var(--border); border-radius:6px; background:rgba(0,0,0,.03); }
details[open] .caret{ transform:rotate(90deg); }
.tree-count{ color:var(--muted); font-size:.85rem; }
.group{ padding:6px 8px 12px; }
.node{ border:1px dashed var(--border); border-radius:10px; margin:8px; background:rgba(0,0,0,.02); }
.node summary{ padding:8px 10px; }
.dir-list{ list-style:none; margin:0; padding:6px; }
.dir-item{ margin:0; padding:0; }
.tree-item{ width:100%; text-align:left; background:transparent; color:var(--text); border:1px solid transparent; padding:8px 10px; border-radius:10px; cursor:pointer; display:flex; align-items:center; gap:8px; }
.tree-item:hover{ background:rgba(0,0,0,.05); border-color:var(--border); }
.tree-item.active{ background:linear-gradient(135deg, var(--primary), var(--primary-2)); color:#06101a; border-color: color-mix(in oklab, var(--border), var(--primary) 40%); }
.bullet{ width:6px; height:6px; border-radius:999px; background:var(--primary); opacity:.9; }

/* right workspace: swapped columns = details LEFT, viewer RIGHT */
.workspace{ display:grid; grid-template-columns: 1fr minmax(620px, 1fr); gap:18px; min-height:60vh; }
@media (max-width:1200px){ .workspace{ grid-template-columns: 1fr; } }

/* details pane (left) */
.details{ display:grid; gap:14px; align-content:start; background:var(--card); border:1px solid var(--border); border-radius:var(--radius); padding:14px; box-shadow:var(--shadow); }
.kicker{ color:var(--muted); margin:0; }
.title{ font-family:"Space Grotesk"; font-size:clamp(28px,3vw,40px); margin:.1rem 0; }
.subtitle{ color:var(--muted); font-weight:500; margin:0; }
.desc{ color: color-mix(in oklab, var(--text), #000 10%); line-height:1.6; margin:.5rem 0 0; }
.info-grid{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
.info-card{ border:1px solid var(--border); background:var(--surface); border-radius:14px; padding:10px 12px; }
.info-title{ color:var(--muted); font-size:.85rem; margin:0 0 6px; }
.pill-row{ display:flex; flex-wrap:wrap; gap:.4rem; }
.pill{ font-size:.8rem; padding:.25rem .6rem; border-radius:999px; border:1px solid var(--border); background:rgba(0,0,0,.02); }
.highlights{ margin:4px 0 0; padding-left:1.1rem; }
.metrics{ display:grid; grid-template-columns: repeat(auto-fill, minmax(160px,1fr)); gap:10px; }
.metric{ border:1px solid var(--border); background:var(--surface); border-radius:12px; padding:.6rem .7rem; }
.metric-label{ color:var(--muted); font-size:.85rem; margin:0; }
.metric-value{ font-weight:700; font-size:1.05rem; margin-top:.15rem; }
.links{ display:flex; gap:.6rem; flex-wrap:wrap; margin-top:.2rem; }

/* viewer pane (right) */
.workbench{ height:calc(100vh - 170px); min-height:540px; background: var(--card); border:1px solid var(--border); border-radius:var(--radius); overflow:hidden; display:flex; flex-direction:column; box-shadow:var(--shadow); }
@media (max-width:1100px){ .workbench{ height: 60vh; } }
.wb-tabs{ display:flex; gap:8px; padding:10px; border-bottom:1px solid var(--border); background:linear-gradient(180deg, rgba(0,0,0,.03), rgba(0,0,0,0)); position:sticky; top:0; z-index:2; }
.tab{ padding:.45rem .8rem; border-radius:999px; border:1px solid var(--border); background:var(--surface); cursor:pointer; font-weight:600; color:var(--text); }
.tab[aria-selected="true"]{ background: linear-gradient(135deg, var(--primary), var(--primary-2)); color:#06101a; border-color: color-mix(in oklab, var(--border), var(--primary) 40%); }
.wb-stage{ position:relative; flex:1; overflow:auto; background:var(--surface); }
.wb-stage iframe{ border:0; width:100%; height:100%; }
pre.code{ margin:0; padding:18px; min-height:100%; font-size:.95rem; }

  </style>
</head>
<body>
  <!-- Site header + nav (styled by provided CSS) -->
  <header class="site-header">
    <div class="header-inner">
      <a class="brand" href="index.html" aria-label="Home">
        <span class="brand-mark">DV</span>
        <span class="brand-text">Dominic Vicchiollo</span>
      </a>
      <button class="nav-toggle" aria-controls="site-nav" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="bar"></span><span class="bar"></span><span class="bar"></span>
      </button>
      <nav id="site-nav" class="site-nav" aria-label="Primary">
        <a href="index.html" class="nav-link">Home</a>
        <a href="projects.html" class="nav-link is-active">Projects</a>
        <a href="domguardianai.html" class="nav-link">DomGuardianAI</a>
      </nav>
    </div>
  </header>

  <!-- Hero / Page heading -->
  <section class="hero">
    <div class="hero-inner container">
      <h1 class="section-title" style="font-size:clamp(2rem,4vw,3rem); margin-top: .75rem;">Projects</h1>
      <p class="lead">Select from the directory on the left; details are now on the left, with a PDF/SQL viewer on the right.</p>
    </div>
  </section>

  <main class="app" id="projects">
    <div class="container app-layout">
      <!-- Directory (left) -->
      <aside class="directory">
        <div class="dir-card">
          <div class="dir-head">
            <span class="dir-title">Directory</span>
          </div>
          <div class="dir-body">
            <div id="dir-tree" class="tree"></div>
          </div>
        </div>
      </aside>

      <!-- Workspace (right): details first, then viewer (swapped) -->
      <section class="workspace">
        <!-- Left: Details -->
        <div class="details">
          <p id="detail-kicker" class="kicker"></p>
          <h2 id="detail-title" class="title"></h2>
          <p id="detail-sub" class="subtitle"></p>
          <p id="detail-desc" class="desc"></p>

          <div class="info-grid">
            <div class="info-card">
              <p class="info-title">Role</p>
              <div id="d-role" class="pill-row"></div>
            </div>
            <div class="info-card">
              <p class="info-title">Tech</p>
              <div id="d-tech" class="pill-row"></div>
            </div>
            <div class="info-card">
              <p class="info-title">Tags</p>
              <div id="d-tags" class="pill-row"></div>
            </div>
            <div class="info-card">
              <p class="info-title">Actions</p>
              <div id="d-links" class="links"></div>
            </div>
          </div>

          <div>
            <p class="info-title" style="margin:.2rem 0 .4rem;">Highlights</p>
            <ul id="d-highlights" class="highlights"></ul>
          </div>

          <div>
            <p class="info-title" style="margin:.2rem 0 .4rem;">Metrics</p>
            <div id="d-metrics" class="metrics"></div>
          </div>
        </div>

        <!-- Right: Viewer -->
        <div class="workbench">
          <div class="wb-tabs" id="wb-tabs"></div>
          <div class="wb-stage" id="wb-stage"><!-- PDF/SQL appear here --></div>
        </div>
      </section>
    </div>
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="container footer-inner">
      <p>© <span id="year"></span> Dominic Vicchiollo</p>
      <div class="social">
        <a href="https://github.com/domvicc" target="_blank" rel="noopener">GitHub</a>
        <a href="https://www.linkedin.com/in/dominicvicchiollo" target="_blank" rel="noopener">LinkedIn</a>
        <a href="mailto:dvicchiollo@gmail.com">Email</a>
      </div>
    </div>
  </footer>

  <!-- Embedded projects data -->
  <script type="application/json" id="projects-data">
  [
    {
      "id": "inventory-audit-journal",
      "title": "Inventory Audit Journal",
      "subtitle": "Reconciling perpetual vs G/L with staged audit layers",
      "description": "Large scripted job creating staging and analysis tables to reconcile perpetual vs G/L, rebate variance, and SPA claim health with repeatable indexes and branching filters.",
      "cover": [{"src":"assets/img/inventory_audit_cover.jpg","alt":"Inventory Audit"}],
      "tags": ["SQL Development","Audit","Inventory"],
      "tech_stack": ["T-SQL","SQL Agent","Indexing"],
      "role": "Data Engineer",
      "links": {
        "repo":"sql/inventory_audit.sql"
      },
      "metrics": [{"label":"Tables","value":"12"},{"label":"Indexes","value":"27"},{"label":"Runtime","value":"< 6m"}],
      "highlights": ["Branching filter paths","Repeatable index strategy","Variance surfacing for Ops"],
      "featured": true
    },
    {
      "id": "product-365-sales",
      "title": "365-Day Product Sales",
      "subtitle": "Rolling 30/90/365 movement and cost for turns",
      "description": "Aggregates rolling movement and cost to feed excess/turns KPIs while isolating returns and enforcing location-type rules.",
      "cover": [{"src":"assets/img/365_sales.jpg","alt":"Sales Coverage"}],
      "tags": ["SQL Development","KPIs","Performance"],
      "tech_stack": ["T-SQL","Window Functions"],
      "role": "Data Engineer",
      "links": {"repo":"sql/product_365_sales.sql"},
      "metrics": [{"label":"Rows/day","value":"40M+"},{"label":"Refresh","value":"Hourly"}],
      "highlights": ["Window functions","Return isolation","Location rules"],
      "featured": true
    },
    {
      "id": "price-matrix-replacement-cost",
      "title": "Price Matrix & Replacement Cost",
      "subtitle": "Unified cost sources and tier logic",
      "description": "Supporting scripts unify cost sources and tier logic to drive margin analytics and downstream contract pricing.",
      "cover": [{"src":"assets/img/price_matrix.jpg","alt":"Price Matrix"}],
      "tags": ["SQL Development","Costing","Margin"],
      "tech_stack": ["T-SQL","ETL"],
      "role": "Data Engineer",
      "links": {"repo":"sql/price_matrix.sql"},
      "metrics": [{"label":"Tiers","value":"7"},{"label":"Latency","value":"< 2m"}],
      "highlights": ["Tier precedence","Margin analytics","Contract pricing feed"],
      "featured": false
    },
    {
      "id": "branch-ledger-feeds",
      "title": "Branch & Ledger Feeds",
      "subtitle": "Dimensions and facts for BI & Finance",
      "description": "Core dimension and fact extracts shaping a governed layer for Power BI and finance reconciliation (A/R, A/P, Inventory).",
      "cover": [{"src":"assets/img/ledger.jpg","alt":"Ledger Feeds"}],
      "tags": ["SQL Development","Operations","Governance"],
      "tech_stack": ["T-SQL","Power BI"],
      "role": "Data Engineer",
      "links": {"repo":"sql/ledger_file.sql"},
      "metrics": [{"label":"Dimensions","value":"12"},{"label":"Facts","value":"9"}],
      "highlights": ["Shared dimensions","BI-ready facts","Recon alignment"],
      "featured": false
    },
    {
      "id": "branch-inventory-foundation",
      "title": "Branch Inventory Foundation",
      "subtitle": "Surrogate keys and indexed attributes",
      "description": "Consolidates product and branch calculation sources; indexes lead time and safety stock attributes for availability and aging analytics.",
      "cover": [{"src":"assets/img/inventory_foundation.jpg","alt":"Inventory Foundation"}],
      "tags": ["SQL Development","Inventory","Performance"],
      "tech_stack": ["T-SQL","Indexing"],
      "role": "Data Engineer",
      "links": {"repo":"sql/product_branch_inventory.sql"},
      "metrics": [{"label":"SLO","value":"p95 < 1.2s"},{"label":"Size","value":"200 GB"}],
      "highlights": ["Consolidated keys","Availability analytics","Aging insights"],
      "featured": false
    },
    {
      "id": "spa-rebate-normalization",
      "title": "SPA & Rebate Normalization",
      "subtitle": "Clean fact for margin reconciliation",
      "description": "Extracts PO and sales linkages, classifies SPA vs SPJ, and materializes a clean rebate fact for variance and eligibility.",
      "cover": [{"src":"assets/img/rebates.jpg","alt":"Rebate Normalization"}],
      "tags": ["SQL Development","Rebates","Margin"],
      "tech_stack": ["T-SQL","Joins"],
      "role": "Data Engineer",
      "links": {"repo":"sql/rebates.sql"},
      "metrics": [{"label":"Link accuracy","value":"99.2%"},{"label":"Records","value":"35M"}],
      "highlights": ["SPA/SPJ classification","Variance surfacing","Eligibility flags"],
      "featured": false
    },
    {
      "id": "tagged-order-variance",
      "title": "Tagged Order Variance",
      "subtitle": "Reconcile sales lines to PO/transfer tags",
      "description": "Reconciles sales lines to PO and transfer tags, flags cost variances, and surfaces broken tag scenarios for correction.",
      "cover": [{"src":"assets/img/tagged_orders.jpg","alt":"Tagged Orders"}],
      "tags": ["SQL Development","Audit","Exceptions"],
      "tech_stack": ["T-SQL"],
      "role": "Data Engineer",
      "links": {"repo":"sql/so_tagged_orders.sql"},
      "metrics": [{"label":"Exceptions/day","value":"~2k"},{"label":"MTTR","value":"< 1d"}],
      "highlights": ["Variance detection","Exception queues","Ops handoff"],
      "featured": false
    },
    {
      "id": "unbilled-ap-exposure",
      "title": "Unbilled AP Exposure",
      "subtitle": "Accrual and payment G/L to UBAP",
      "description": "Produces an unbilled payable ledger combining accrual and payment G/L postings to monitor aging and exceptions before liability surprises.",
      "cover": [{"src":"assets/img/unbilled_ap.jpg","alt":"Unbilled AP"}],
      "tags": ["Finance","Controls","AP"],
      "tech_stack": ["T-SQL"],
      "role": "Data Engineer",
      "links": {"repo":"sql/ap_unbilled.sql"},
      "metrics": [{"label":"Exposure delta","value":"−18%"},{"label":"Alerts","value":"Daily"}],
      "highlights": ["Aging visibility","Pre-invoice signals","Finance alignment"],
      "featured": false
    },
    {
      "id": "covid-workforce-planning",
      "title": "COVID-19 Workforce Planning & Reporting",
      "subtitle": "Productivity vs. hours to inform staffing",
      "description": "Executive dashboard measuring productivity against working hours to manage workforce utilization during the pandemic; contributed to zero layoffs.",
      "cover": [{"src":"assets/img/workforce.jpg","alt":"Workforce Planning"}],
      "tags": ["Operations","Case Study","Power BI","Analytics"],
      "tech_stack": ["SQL","Power BI","SSMS"],
      "role": "Analytics Engineer",
      "links": {"case_study":"assets/pdfjs/web/viewer.html?file=../../pdf/operational_productivity.pdf"},
      "metrics": [{"label":"Teams","value":"6"},{"label":"Dashboards","value":"4"}],
      "highlights": ["Exec-ready visuals","Utilization insights","Schedule optimization"],
      "featured": true
    },
    {
      "id": "lakehouse-synapse-strategy",
      "title": "Lakehouse & Synapse Strategy",
      "subtitle": "ADLS Gen2 + Synapse (serverless/dedicated)",
      "description": "Azure-first lake design with governed zones and shared definitions for BI; cost-aware and reliable.",
      "cover": [{"src":"assets/img/lakehouse.jpg","alt":"Lakehouse"}],
      "tags": ["Architecture","Platform","Governance"],
      "tech_stack": ["ADLS Gen2","Synapse","RBAC/RLS"],
      "role": "Architect",
      "links": {},
      "metrics": [{"label":"Zones","value":"3"},{"label":"Cost ↓","value":"~22%"}],
      "highlights": ["Zone governance","Shared dimensions","Cost control"],
      "featured": false
    },
    {
      "id": "minwage-compliance-dashboard",
      "title": "Minimum Wage Compliance Dashboard",
      "subtitle": "Blending BLS CPI with multi-level wage rules",
      "description": "Power BI dashboard with ratio trends and alerts across federal/state/county/city minimum-wage rules.",
      "cover": [{"src":"assets/img/minwage.jpg","alt":"Minimum Wage Dashboard"}],
      "tags": ["Compliance","Research","Analytics"],
      "tech_stack": ["Power BI","Azure","Python"],
      "role": "Analytics Engineer",
      "links": {},
      "metrics": [{"label":"Jurisdictions","value":"500+"},{"label":"Alert latency","value":"< 1 day"}],
      "highlights": ["CPI overlays","Multi-level rules","Alerting"],
      "featured": true
    },
    {
      "id": "direct-through-stock-strategy",
      "title": "Direct / Through Stock Strategy",
      "subtitle": "Optimizing fulfillment path mix for margin & service",
      "description": "Analysis and playbook comparing direct-ship vs. stock pathways, quantifying freight avoidance, service-level impact, and working capital trade‑offs.",
      "cover": [{"src":"assets/img/inventory_audit_totals.png","alt":"Direct vs Stock"}],
      "tags": ["Operations","Supply Chain","Case Study"],
      "tech_stack": ["SQL","Power BI"],
      "role": "Data / Ops Analyst",
      "links": {"case_study":"assets/pdfjs/web/viewer.html?file=../../pdf/direct_through_stock.pdf"},
      "metrics": [{"label":"Freight savings","value":"~5-8%"},{"label":"Working capital","value":"↓ selective"}],
      "highlights": ["Path mix segmentation","Freight vs carry cost model","Actionable routing rules"],
      "featured": false
    },
    {
      "id": "injury-reporting-workflow",
      "title": "Injury Reporting Workflow",
      "subtitle": "Standardized HR & safety escalation path",
      "description": "Flow design reducing lag between incident, documentation, and corrective action; codifies notifications and data capture points.",
      "cover": [{"src":"assets/img/inventory_audit_perpetual_vs_gl.png","alt":"Injury Workflow"}],
      "tags": ["HR","Safety","Process"],
      "tech_stack": ["Visio","SharePoint"],
      "role": "Process Designer",
      "links": {"case_study":"assets/pdfjs/web/viewer.html?file=../../pdf/hr_injury_flow.pdf"},
      "metrics": [{"label":"Report lag","value":"↓ 40%"},{"label":"Forms standardized","value":"100%"}],
      "highlights": ["Escalation timing","Unified intake form","Compliance alignment"],
      "featured": false
    },
    {
      "id": "routing-driver-setup",
      "title": "Routing & Driver Setup Guide",
      "subtitle": "Onboarding & configuration for routing platform",
      "description": "Driver, vehicle, and route template setup reference reducing onboarding variability and improving first-week route adherence.",
      "cover": [{"src":"assets/img/ledger.jpg","alt":"Routing Setup"}],
      "tags": ["Logistics","Enablement","Case Study"],
      "tech_stack": ["SaaS Routing","Excel"],
      "role": "Operations Analyst",
      "links": {"case_study":"assets/pdfjs/web/viewer.html?file=../../pdf/innovo_routing_driver_setup.pdf"},
      "metrics": [{"label":"Onboard time","value":"↓ 30%"},{"label":"Route adherence","value":"↑ 8 pts"}],
      "highlights": ["Standard templates","Driver profile checklist","Faster activation"],
      "featured": false
    },
    {
      "id": "job-freight-management-flow",
      "title": "Job & Freight Management Flow",
      "subtitle": "Coordinating job quotes → shipment → confirmation",
      "description": "Process map clarifying handoffs among sales, dispatch, and warehouse for complex freight & job orders to cut rework and delays.",
      "cover": [{"src":"assets/img/price_matrix.jpg","alt":"Job & Freight Flow"}],
      "tags": ["Process","Logistics","Operations"],
      "tech_stack": ["Visio","ERP"],
      "role": "Process Analyst",
      "links": {"case_study":"assets/pdfjs/web/viewer.html?file=../../pdf/job_management_frieght_flow_chart.pdf"},
      "metrics": [{"label":"Rework tickets","value":"↓ 18%"},{"label":"Touchpoints clarified","value":"12"}],
      "highlights": ["Defined swimlanes","Exception branching","Status visibility"],
      "featured": false
    },
    {
      "id": "rf-operations-manual",
      "title": "RF Operations Manual",
      "subtitle": "Standard device usage & inventory tasks",
      "description": "Reference manual for RF (handheld) transactions – receiving, picking, cycle count – reducing training time and errors.",
      "cover": [{"src":"assets/img/tagged_orders.jpg","alt":"RF Manual"}],
      "tags": ["Warehouse","Enablement","Training"],
      "tech_stack": ["WMS","RF"],
      "role": "Operations Trainer",
      "links": {"case_study":"assets/pdfjs/web/viewer.html?file=../../pdf/rf_manual.pdf"},
      "metrics": [{"label":"Training hours","value":"↓ 25%"},{"label":"Pick accuracy","value":"↑ 2.5 pts"}],
      "highlights": ["Task screenshots","Error recovery steps","Role-based sections"],
      "featured": false
    },
    {
      "id": "vendor-performance-scorecard",
      "title": "Vendor Performance Scorecard",
      "subtitle": "On-time, fill rate, defect & rebate visibility",
      "description": "Supplier scorecard consolidating OTIF, defect metrics, and rebate realization to drive quarterly vendor business reviews.",
      "cover": [{"src":"assets/img/rebates.jpg","alt":"Vendor Scorecard"}],
      "tags": ["Supply Chain","Analytics","Governance"],
      "tech_stack": ["SQL","Power BI"],
      "role": "Analytics Engineer",
      "links": {"case_study":"assets/pdfjs/web/viewer.html?file=../../pdf/vendor_scorecard.pdf"},
      "metrics": [{"label":"Vendors tracked","value":"150+"},{"label":"OTIF improvement","value":"+6 pts"}],
      "highlights": ["Unified KPI layer","Exception ranking","Quarterly review pack"],
      "featured": false
    }
  ]
  </script>

  <!-- App script: build directory and wire workspace (details left, viewer right) -->
  <script>
(() => {
  const $ = (s, r=document) => r.querySelector(s);
  const $$ = (s, r=document) => [...r.querySelectorAll(s)];
  const byId = id => document.getElementById(id);

  // load data
  let projects = [];
  try { projects = JSON.parse(byId('projects-data').textContent.trim()); }
  catch (e) { console.error('Invalid JSON in #projects-data', e); return; }

  // elements
  const tree = byId('dir-tree');
  const tabs = byId('wb-tabs');
  const stage = byId('wb-stage');
  const els = {
    kicker: byId('detail-kicker'),
    title: byId('detail-title'),
    sub: byId('detail-sub'),
    desc: byId('detail-desc'),
    role: byId('d-role'),
    tech: byId('d-tech'),
    tags: byId('d-tags'),
    highlights: byId('d-highlights'),
    metrics: byId('d-metrics'),
    links: byId('d-links'),
  };

  // Build directory structure
  buildDirectory();

  function buildDirectory(){
    tree.innerHTML = '';

    // All Projects
    tree.appendChild(sectionNode('All Projects', projects.length, listNode(sortByTitle(projects))));

    // Tags
    const tagMap = new Map();
    projects.forEach(p => (p.tags||[]).forEach(t => { if (!tagMap.has(t)) tagMap.set(t, []); tagMap.get(t).push(p); }));
    const tagsWrap = document.createElement('div'); tagsWrap.className = 'group';
    [...tagMap.entries()].sort((a,b)=>a[0].localeCompare(b[0])).forEach(([tag, arr]) => {
      tagsWrap.appendChild(sectionNode(tag, arr.length, listNode(sortByTitle(arr)), 'node'));
    });
    tree.appendChild(sectionNode('Tags', tagMap.size, tagsWrap));

    // Tech
    const techMap = new Map();
    projects.forEach(p => (p.tech_stack||[]).forEach(t => { if (!techMap.has(t)) techMap.set(t, []); techMap.get(t).push(p); }));
    const techWrap = document.createElement('div'); techWrap.className = 'group';
    [...techMap.entries()].sort((a,b)=>a[0].localeCompare(b[0])).forEach(([tech, arr]) => {
      techWrap.appendChild(sectionNode(tech, arr.length, listNode(sortByTitle(arr)), 'node'));
    });
    tree.appendChild(sectionNode('Tech', techMap.size, techWrap));

    // Activate first item by default
    const firstBtn = tree.querySelector('.dir-list .tree-item');
    if (firstBtn) firstBtn.click();
  }

  function sectionNode(label, count, childContent, cls=''){
    const det = document.createElement('details');
    det.className = cls ? 'tree-node '+cls : 'tree-node';
    det.open = true;
    const sum = document.createElement('summary');
    sum.innerHTML = '<span>'+label+'</span><span class="tree-count">'+count+'</span>';
    const caret = document.createElement('span'); caret.className='caret'; caret.textContent='›';
    sum.prepend(caret);
    det.appendChild(sum);
    if (childContent) det.appendChild(childContent);
    return det;
  }

  function listNode(items){
    const ul = document.createElement('ul'); ul.className='dir-list';
    items.forEach(p => {
      const li = document.createElement('li'); li.className='dir-item';
      const btn = document.createElement('button'); btn.className='tree-item'; btn.dataset.id=p.id;
      btn.innerHTML = '<span class="bullet"></span><span>'+p.title+'</span>';
      btn.addEventListener('click', () => selectProject(p.id, btn));
      li.appendChild(btn); ul.appendChild(li);
    });
    return ul;
  }

  function selectProject(id, btn){
    // active state
    $$('.tree-item').forEach(b => b.classList.toggle('active', b === btn));
    const p = projects.find(x => x.id === id);
    if (!p) return;
    openProject(p);
  }

  function openProject(p){
    // details (left)
    els.kicker.textContent = (p.tags||[]).slice(0,1).join(' • ');
    els.title.textContent = p.title;
    els.sub.textContent = p.subtitle || '';
    els.desc.textContent = p.description || '';
    els.role.innerHTML = ''; if (p.role) els.role.appendChild(pill(p.role));
    els.tech.innerHTML = ''; (p.tech_stack||[]).forEach(t => els.tech.appendChild(pill(t)));
    els.tags.innerHTML = ''; (p.tags||[]).forEach(t => els.tags.appendChild(pill(t)));
    els.highlights.innerHTML = ''; (p.highlights||[]).forEach(hh => els.highlights.appendChild(li(hh)));
    els.metrics.innerHTML = ''; (p.metrics||[]).forEach(m => els.metrics.appendChild(metric(m.label, m.value)));
    els.links.innerHTML = '';
    if (p.links?.demo) els.links.appendChild(linkBtn('Open demo', p.links.demo));
    if (p.links?.repo) els.links.appendChild(linkBtn('Open repo', p.links.repo));
    if (p.links?.case_study) els.links.appendChild(linkBtn('Open PDF', p.links.case_study));

    // viewer (right)
    tabs.innerHTML=''; stage.innerHTML='';
    const tb = [];
    if (p.links?.case_study) tb.push({id:'pdf', label:'PDF'});
    if (p.links?.repo) tb.push({id:'sql', label:'SQL'});
    if (!tb.length) tb.push({id:'cover', label:'Preview'});
    tb.forEach((t,i)=>{
      const b = document.createElement('button'); b.className='tab'; b.textContent=t.label; b.dataset.id=t.id;
      b.setAttribute('aria-selected', i===0 ? 'true' : 'false');
      b.addEventListener('click',()=>setTab(t.id,p));
      tabs.appendChild(b);
    });
    setTab(tb[0].id,p);
  }

  function setTab(id, p){
    $$('#wb-tabs .tab').forEach(b => b.setAttribute('aria-selected', b.dataset.id === id ? 'true' : 'false'));
    stage.innerHTML = '';
    if (id === 'pdf' && p.links?.case_study){
      const frame = document.createElement('iframe');
      frame.src = p.links.case_study;
      stage.appendChild(frame);
    } else if (id === 'sql' && p.links?.repo){
      const pre = document.createElement('pre'); pre.className = 'code';
      const code = document.createElement('code'); code.className = 'language-sql'; code.textContent = 'Loading SQL…';
      pre.appendChild(code); stage.appendChild(pre);
      fetch(p.links.repo, {cache:'no-store'}).then(r => r.ok ? r.text() : Promise.reject(r.status)).then(txt => {
        code.textContent = txt; if (window.hljs) window.hljs.highlightElement(code);
      }).catch(()=>{ code.textContent = 'Could not load SQL file. Use "Open repo" to view it.'; });
    } else {
      const img = document.createElement('img');
      img.alt = p?.cover?.[0]?.alt || p.title;
      img.src = p?.cover?.[0]?.src || 'assets/img/placeholder.jpg';
      img.style.width='100%'; img.style.height='100%'; img.style.objectFit='cover';
      stage.appendChild(img);
    }
  }

  // tiny builders
  function pill(text){ const s=document.createElement('span'); s.className='pill'; s.textContent=text; return s; }
  function li(text){ const n=document.createElement('li'); n.textContent=text; return n; }
  function metric(label, value){ const c=document.createElement('div'); c.className='metric'; const l=document.createElement('p'); l.className='metric-label'; l.textContent=label; const v=document.createElement('p'); v.className='metric-value'; v.textContent=value; c.append(l,v); return c; }
  function linkBtn(label, href){ const a=document.createElement('a'); a.className='btn ghost'; a.target='_blank'; a.rel='noopener'; a.href=href; a.textContent=label; return a; }

  // footer year + mobile nav
  const y = byId('year'); if (y) y.textContent = new Date().getFullYear();
  const toggle = document.querySelector('.nav-toggle'); const nav = document.getElementById('site-nav');
  if (toggle && nav) toggle.addEventListener('click', () => {
    const open = nav.classList.toggle('open'); toggle.setAttribute('aria-expanded', open ? 'true' : 'false');
  });
  if (window.hljs) window.hljs.highlightAll?.();

  // helpers
  function sortByTitle(arr){ return arr.slice().sort((a,b)=>a.title.localeCompare(b.title)); }
})();
  </script>
</body>
</html>
